<script>
  // --- Your FAQ code remains unchanged below ---
  let faqData = [];
  const listEl = document.getElementById('qa-list');
  const searchInput = document.getElementById('search');

  fetch('https://opensheet.elk.sh/1lcfJ-OKpeF4A6u9A2rs6CvMcncv7cp8O9IG61J96Tec/Support')
    .then(res => res.json())
    .then(data => {
      faqData = data;
      render(faqData);
    });

  searchInput.addEventListener('input', function() {
    const q = this.value.trim().toLowerCase();
    if (!q) return render(faqData);
    render(faqData.filter(item =>
      (item.Question || '').toLowerCase().includes(q)
    ));
  });

  function render(data) {
    listEl.innerHTML = '';
    if (!data.length) {
      listEl.innerHTML = `<p style="text-align:center;color:#888;">No results found.</p>`;
      return;
    }
    data.forEach(item => {
      if (item.Question && item.View) {
        listEl.innerHTML += `
          <div class="qa">
            <a href="${item.View}" target="_blank" class="question">${item.Question}</a>
          </div>
        `;
      }
    });
  }

  // --- New: Real-time grammar/spelling correction for questionInput ---
  let correctionTimeout = null;

  async function correctQuestion(text) {
    const apiKey = 'sk-...'; // <-- YOUR OpenAI API key
    const response = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Authorization": "Bearer " + apiKey,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        model: "gpt-3.5-turbo",
        messages: [
          {role: "system", content: "Correct this question for spelling and grammar, but don't change the meaning."},
          {role: "user", content: text}
        ],
        max_tokens: 60
      })
    });
    const data = await response.json();
    return data.choices[0].message.content.trim();
  }

  const input = document.getElementById('questionInput');
  const msg = document.getElementById('autocorrectMsg');

  input.addEventListener('blur', async function() {
    if (input.value.trim().length < 3) return;
    msg.textContent = "Checking spelling…";
    input.disabled = true;
    let corrected = await correctQuestion(input.value);
    input.value = corrected;
    input.disabled = false;
    msg.textContent = "Auto-corrected!";
    setTimeout(() => { msg.textContent = ""; }, 1200);
  });

  input.addEventListener('input', function() {
    clearTimeout(correctionTimeout);
    correctionTimeout = setTimeout(async () => {
      if (input.value.trim().length < 3) return;
      msg.textContent = "Checking spelling…";
      input.disabled = true;
      let corrected = await correctQuestion(input.value);
      input.value = corrected;
      input.disabled = false;
      msg.textContent = "Auto-corrected!";
      setTimeout(() => { msg.textContent = ""; }, 1200);
    }, 2000); // 2 seconds pause after typing
  });
</script>

